<subsystem>
    <import>controller_common</import>
    <import>rtt_geometry_msgs</import>
    <import>rtt_velma_core_cs_ve_body_msgs</import>
    <import>rtt_velma_core_cs_ve_body_subsystem_ports</import>
    <import>velma_core_ve_body</import>
    <import>rtt_velma_core_ve_body_re_body_msgs</import>
    <import>rtt_velma_core_ve_body_re_body_subsystem_ports</import>
    <import>eigen_typekit</import>
    <import>rtt_std_msgs</import>
    <import>port_operations</import>
    <import>rtt_control_msgs</import>
    <import>lwr_fri</import>
    <import>velma_controller</import>
    <import>rtt_cartesian_trajectory_msgs</import>
    <import>rtt_std_msgs</import>
    <import>rtt_tf</import>
    <import>velma_sim_gazebo</import>

    <component name="TorsoSim" running="true" />
    <component name="LWRrSim" running="true" />
    <component name="LWRlSim" running="true" />
    <component name="LeftFtSensor" running="true" />
    <component name="RightFtSensor" running="true" />

    <component name="TorsoPanTransmision"       type="SimpleTransmision" />
    <component name="TorsoPanTransmisionInv"    type="SimpleTransmisionInv" />
    <component name="HeadPanTransmision"        type="SimpleTransmision" running="true" />
    <component name="HeadPanTransmisionInv"     type="SimpleTransmisionInv" running="true" />
    <component name="HeadTiltTransmision"       type="SimpleTransmision" running="true" />
    <component name="HeadTiltTransmisionInv"    type="SimpleTransmisionInv" running="true" />

    <component name="bypass" type="velma_core_ve_body_types::BypassComponent" />
    <component name="safe" type="velma_core_ve_body_types::SafeComponent" />
    <component name="packet_counter" type="velma_core_ve_body_types::PacketCounterComponent" running="true" />

    <io_buffer alias="hi_st" name="velma_core_cs_ve_body_msgs_Status" />
    <io_buffer alias="hi_cmd" name="velma_core_cs_ve_body_msgs_Command" />
    <io_buffer alias="lo_cmd" name="velma_core_ve_body_re_body_msgs_Command" />
    <io_buffer alias="lo_st" name="velma_core_ve_body_re_body_msgs_Status" />

    <ros_stream port="lo_stConcate.msg_OUTPORT"        topic="/velma_core_ve_body/lo_st" />
    <ros_stream port="master_component.hi_cmd_OUTPORT"      topic="/velma_core_ve_body/hi_cmd" />

    <ros_stream port="hi_stConcate.msg_OUTPORT"             topic="/velma_core_ve_body/hi_st" />


    <connection from="hi_cmdSplit.hpMotor_q_OUTPORT" to="HeadPanTransmisionInv.JointPosition_INPORT" />
    <connection from="HeadPanTransmisionInv.MotorPosition_OUTPORT" to="bypass.cmd_hpMotor_q_INPORT" />

    <connection from="hi_cmdSplit.htMotor_q_OUTPORT" to="HeadTiltTransmisionInv.JointPosition_INPORT" />
    <connection from="HeadTiltTransmisionInv.MotorPosition_OUTPORT" to="bypass.cmd_htMotor_q_INPORT" />



    <connection from="TorsoSim.head_pan_motor_position_OUTPORT"         to="HeadPanTransmision.MotorPosition_INPORT" />
    <connection from="TorsoSim.head_pan_motor_velocity_OUTPORT"         to="HeadPanTransmision.MotorVelocity_INPORT" />
    <connection from="HeadPanTransmision.JointPosition_OUTPORT"         to="hi_stConcate.hpMotor_q_INPORT" />
    <connection from="HeadPanTransmision.JointVelocity_OUTPORT"         to="hi_stConcate.hpMotor_dq_INPORT" />

    <connection from="TorsoSim.head_tilt_motor_position_OUTPORT"        to="HeadTiltTransmision.MotorPosition_INPORT" />
    <connection from="TorsoSim.head_tilt_motor_velocity_OUTPORT"        to="HeadTiltTransmision.MotorVelocity_INPORT" />
    <connection from="HeadTiltTransmision.JointPosition_OUTPORT" to="hi_stConcate.htMotor_q_INPORT" />
    <connection from="HeadTiltTransmision.JointVelocity_OUTPORT" to="hi_stConcate.htMotor_dq_INPORT" />





    <connection from="TorsoSim.t_MotorPosition_OUTPORT" to="TorsoPanTransmision.MotorPosition_INPORT" />
    <connection from="TorsoSim.t_MotorVelocity_OUTPORT" to="TorsoPanTransmision.MotorVelocity_INPORT" />


    <connection from="lo_stConcate.msg_OUTPORT" to="safe.status_INPORT" />
    <connection from="safe.cmd_OUTPORT" to="lo_cmdConcate._INPORT" />
    <connection from="safe.sc_OUTPORT" to="hi_stConcate.sc_INPORT" />

    <connection from="lo_cmdSplit.rArm_t_OUTPORT" to="LWRrSim.JointTorqueCommand_INPORT" />
    <connection from="lo_cmdSplit.rArmFri_OUTPORT" to="LWRrSim.KRL_CMD_INPORT" />

    <connection from="lo_cmdSplit.lArm_t_OUTPORT" to="LWRlSim.JointTorqueCommand_INPORT" />
    <connection from="lo_cmdSplit.lArmFri_OUTPORT" to="LWRlSim.KRL_CMD_INPORT" />

    <connection from="lo_cmdSplit.tMotor_i_OUTPORT" to="TorsoSim.t_MotorCurrentCommand_INPORT" />
    <connection from="lo_cmdSplit.hpMotor_q_OUTPORT"          to="TorsoSim.head_pan_motor_position_command_INPORT" />
    <connection from="lo_cmdSplit.htMotor_q_OUTPORT"          to="TorsoSim.head_tilt_motor_position_command_INPORT" />
    <connection from="lo_cmdSplit.hpMotor_dq_OUTPORT"         to="TorsoSim.head_pan_motor_velocity_command_INPORT" />
    <connection from="lo_cmdSplit.htMotor_dq_OUTPORT"         to="TorsoSim.head_tilt_motor_velocity_command_INPORT" />


    
    <connection from="hi_cmdSplit.tMotor_i_OUTPORT" to="TorsoPanTransmisionInv.JointTorque_INPORT" />
    <connection from="TorsoPanTransmisionInv.MotorCurrent_OUTPORT" to="bypass.cmd_tMotor_INPORT" />
    <connection from="hi_cmdSplit.lArm_OUTPORT" to="bypass.cmd_lArm_INPORT" />
    <connection from="hi_cmdSplit.rArm_OUTPORT" to="bypass.cmd_rArm_INPORT" />
    <connection from="hi_cmdSplit.lHand_OUTPORT" to="bypass.cmd_lHand_INPORT" />
    <connection from="hi_cmdSplit.rHand_OUTPORT" to="bypass.cmd_rHand_INPORT" />
    <connection from="bypass.command_OUTPORT" to="lo_cmdConcate._INPORT" />
    <connection from="bypass.sc_OUTPORT" to="hi_stConcate.sc_INPORT" />

    <connection from="packet_counter.packet_counter_OUTPORT"            to="hi_stConcate.test_INPORT" />

    <connection from="LWRrSim.JointPosition_OUTPORT"                    to="hi_stConcate.rArm_q_INPORT" />
    <connection from="LWRrSim.JointVelocity_OUTPORT"                    to="hi_stConcate.rArm_dq_INPORT" />
    <connection from="LWRrSim.JointTorque_OUTPORT"                      to="hi_stConcate.rArm_t_INPORT" />
    <connection from="LWRrSim.GravityTorque_OUTPORT"                    to="hi_stConcate.rArm_gt_INPORT" />
    <connection from="LWRrSim.CartesianWrench_OUTPORT"                  to="hi_stConcate.rArm_w_INPORT" />
    <connection from="LWRrSim.MassMatrix_OUTPORT"                       to="hi_stConcate.rArm_mmx_INPORT" />

    <connection from="LWRlSim.JointPosition_OUTPORT"                    to="hi_stConcate.lArm_q_INPORT" />
    <connection from="LWRlSim.JointVelocity_OUTPORT"                    to="hi_stConcate.lArm_dq_INPORT" />
    <connection from="LWRlSim.JointTorque_OUTPORT"                      to="hi_stConcate.lArm_t_INPORT" />
    <connection from="LWRlSim.GravityTorque_OUTPORT"                    to="hi_stConcate.lArm_gt_INPORT" />
    <connection from="LWRlSim.CartesianWrench_OUTPORT"                  to="hi_stConcate.lArm_w_INPORT" />
    <connection from="LWRlSim.MassMatrix_OUTPORT"                       to="hi_stConcate.lArm_mmx_INPORT" />

    <connection from="TorsoPanTransmision.JointPosition_OUTPORT"        to="hi_stConcate.tMotor_q_INPORT" />
    <connection from="TorsoPanTransmision.JointVelocity_OUTPORT"        to="hi_stConcate.tMotor_dq_INPORT" />

    <connection from="RightFtSensor.rawWrench_OUTPORT"                  to="hi_stConcate.rFt_rw_INPORT" />
    <connection from="RightFtSensor.fastFilteredWrench_OUTPORT"         to="hi_stConcate.rFt_ffw_INPORT" />
    <connection from="RightFtSensor.slowFilteredWrench_OUTPORT"         to="hi_stConcate.rFt_sfw_INPORT" />
    <connection from="LeftFtSensor.rawWrench_OUTPORT"                   to="hi_stConcate.lFt_rw_INPORT" />
    <connection from="LeftFtSensor.fastFilteredWrench_OUTPORT"          to="hi_stConcate.lFt_ffw_INPORT" />
    <connection from="LeftFtSensor.slowFilteredWrench_OUTPORT"          to="hi_stConcate.lFt_sfw_INPORT" />

    <connection from="LWRrSim.JointPosition_OUTPORT"                    to="lo_stConcate.rArm_q_INPORT" />
    <connection from="LWRrSim.JointVelocity_OUTPORT"                    to="lo_stConcate.rArm_dq_INPORT" />
    <connection from="LWRrSim.JointTorque_OUTPORT"                      to="lo_stConcate.rArm_t_INPORT" />
    <connection from="LWRrSim.GravityTorque_OUTPORT"                    to="lo_stConcate.rArm_gt_INPORT" />
    <connection from="LWRrSim.CartesianWrench_OUTPORT"                  to="lo_stConcate.rArm_w_INPORT" />
    <connection from="LWRrSim.MassMatrix_OUTPORT"                       to="lo_stConcate.rArm_mmx_INPORT" />
    <connection from="LWRrSim.FRIState_OUTPORT"                         to="lo_stConcate.rArmFriIntf_INPORT" />
    <connection from="LWRrSim.RobotState_OUTPORT"                       to="lo_stConcate.rArmFriRobot_INPORT" />

    <connection from="LWRlSim.JointPosition_OUTPORT"                    to="lo_stConcate.lArm_q_INPORT" />
    <connection from="LWRlSim.JointVelocity_OUTPORT"                    to="lo_stConcate.lArm_dq_INPORT" />
    <connection from="LWRlSim.JointTorque_OUTPORT"                      to="lo_stConcate.lArm_t_INPORT" />
    <connection from="LWRlSim.GravityTorque_OUTPORT"                    to="lo_stConcate.lArm_gt_INPORT" />
    <connection from="LWRlSim.CartesianWrench_OUTPORT"                  to="lo_stConcate.lArm_w_INPORT" />
    <connection from="LWRlSim.MassMatrix_OUTPORT"                       to="lo_stConcate.lArm_mmx_INPORT" />
    <connection from="LWRlSim.FRIState_OUTPORT"                         to="lo_stConcate.lArmFriIntf_INPORT" />
    <connection from="LWRlSim.RobotState_OUTPORT"                       to="lo_stConcate.lArmFriRobot_INPORT" />
    <connection from="TorsoSim.t_MotorPosition_OUTPORT"                 to="lo_stConcate.tMotor_q_INPORT" />
    <connection from="TorsoSim.t_MotorVelocity_OUTPORT"                 to="lo_stConcate.tMotor_dq_INPORT" />
    <connection from="TorsoSim.head_pan_motor_position_OUTPORT"         to="lo_stConcate.hpMotor_q_INPORT" />
    <connection from="TorsoSim.head_pan_motor_velocity_OUTPORT"         to="lo_stConcate.hpMotor_dq_INPORT" />
    <connection from="TorsoSim.head_tilt_motor_position_OUTPORT"        to="lo_stConcate.htMotor_q_INPORT" />
    <connection from="TorsoSim.head_tilt_motor_velocity_OUTPORT"        to="lo_stConcate.htMotor_dq_INPORT" />

    <connection from="RightFtSensor.rawWrench_OUTPORT"                  to="lo_stConcate.rFt_rw_INPORT" />
    <connection from="RightFtSensor.fastFilteredWrench_OUTPORT"         to="lo_stConcate.rFt_ffw_INPORT" />
    <connection from="RightFtSensor.slowFilteredWrench_OUTPORT"         to="lo_stConcate.rFt_sfw_INPORT" />
    <connection from="LeftFtSensor.rawWrench_OUTPORT"                   to="lo_stConcate.lFt_rw_INPORT" />
    <connection from="LeftFtSensor.fastFilteredWrench_OUTPORT"          to="lo_stConcate.lFt_ffw_INPORT" />
    <connection from="LeftFtSensor.slowFilteredWrench_OUTPORT"          to="lo_stConcate.lFt_sfw_INPORT" />
</subsystem>

